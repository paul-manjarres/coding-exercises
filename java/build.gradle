plugins {
    id 'java'
    id 'com.diffplug.spotless' version "7.0.2"
    id 'io.github.paul-manjarres.test-time-reporter' version "0.13"
}

repositories {
    mavenCentral()
}

group = 'com.jpmanjarres'
version = '0.0.1'

java{
    toolchain{
        languageVersion = JavaLanguageVersion.of(24)
    }
}

dependencies {
    testImplementation(platform('org.junit:junit-bom:5.12.1'))
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
    testImplementation('org.junit.jupiter:junit-jupiter')
    testImplementation 'org.assertj:assertj-core:3.25.2'
}

tasks.withType(JavaCompile).configureEach {
    options.encoding = 'UTF-8'
}

tasks.named('test') {
    useJUnitPlatform()
    failFast(false)
    testLogging {
        showStandardStreams(false)
        events("skipped", "failed")
        exceptionFormat("full")
    }
}

spotless {
    java {
        encoding("UTF-8")
        importOrder()
        removeUnusedImports()
        palantirJavaFormat()
        formatAnnotations()
        trimTrailingWhitespace()
    }
    //lineEndings = LineEnding.GIT_ATTRIBUTES_FAST_ALLSAME
}

afterEvaluate {
    tasks.spotlessCheck {
        dependsOn(tasks.spotlessApply)
    }
}